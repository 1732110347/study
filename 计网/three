3.1 数据链路层概述
链路(Link)就是从一个结点到相邻结点的一段物理线路，而中间没有任何其他的交互结点
数据链路(Data Link) 是指把实现通信协议的硬件和软件加到链路上，就构成了数据链路
数据链路层以帧为单位传输和处理数据


3.2 封装成帧
透明传输是指数据链路层对上层交付的传输数据没有任何限制，就好像数据链路层不存在一样
面向字节的物理链路使用字节填充 或称字符填充的方法

面向比特的物理链路使用比特填充的方法实现透明传输
5个1后填0
帧首 01111110   帧尾 01111110


3.3 差错检测
在一段时间内，传输错误的比特占所传输比特总数的比率称为误码率BER

奇偶校验
1数量为偶数加1进行奇校验
1数量为奇数加0进行偶校验

循环冗余校验CRC
收发双方约定好一个生成多项式G(x)
发送方基于带发送的数据和生成多项式计算出差错检测码(冗余码) 将其添加到传输数据的后面一起传输
接收方通过生成多项式来计算收到的数据是否产生了误码

CRC-16=x16+x15+x2+1
CRC-CCITT=x16+x12+x5+1
CRC-32=x32+x26+x23+x22+x16+x12+x11+x10+x8+x7+x5+X4+x2+x+1

101001  生成多项式G(x)=x3+x2+1
1 构造被除数 待发送信息后面添加生成多项式最高次数个0
101001000

2构造除数 生成多项式各项系数构成的比特串
1101

3 做除法
异或运算 不同为1

4 检查余数 余数的位数应与生成多项式最高次数相同，如果位数不够，则在余数前补0来凑足位数
001

1 构造被除数 接收到的信息就是被除数

2构造除数 生成多项式各项系数构成的比特串

3 做除法
异或运算 不同为1

4 检查余数 余数为0则无误码 不为0则有


3.4.1 可靠传输的基本概念
数据链路层向上提供的服务类型
不可靠传输服务:仅仅丢弃有误码的帧，其他什么也不做
可靠传输服务：想办法实现发送端发送什么，接收端就收到什么

比特差错只是传输差错中的一种

从整个计算机网络体系结构来看，传输差错还包括分组丢失、分组失序、分组重复

分组这些传输差错，一般不会出现在数据链路层，而会出现在其上层

可靠传输服务并不仅局限于数据链路层，其他各层均课选择实现可靠传输

 
3.4.2 可靠传输的实现机制 停止-等待协议SW
接收端检测到数据分组有误码时，将其丢弃并等待发送方的超时重传。对于误码率较高的点对点链路
为使对方尽快重传，也可给发送方发送NAK分组

为了让接收方能够判断所收到的数据分组是否是重复的，需要给数据分组编号。由于协议的停等特性，
只需1个比特编号就够了，即编号0和1

为了让发送方能够判断所收到的ACK分组是否重复，需要给ACK分组编号，所用比特数量与数据分组编号所用比特数量一样。
数据链路层一般不会出现ACK分组迟到的情况，因此在数据链路层实现停止-等待协议可以不用给ACK分组编号

超时计数器设置的重传时间应仔细选择，一般可将重传时间略大于 平均往返时间


自动请求重传ARQ


3.4.3 回退N帧协议GBN
ACKn表示之前的接收成功


3.4.4 选择重传协议SR
选择重传协议为了使发送方仅重传出现差错的分组，接收方不能再采用累计确认，而需要对每个正确
接收的数据分组进行逐一确认

接收窗口的尺寸Wr应大于1

发送窗口Wt取值 1<Wt<=2^n-1

接收方 1<Wr<=Wt 


3.5 点对点协议PPP
PPP协议为在点对点链路传输各种协议数据报提供了一个标准方法，主要由以下三部分构成

对各种协议数据报的封装方法(封装成帧)
链路控制协议LCP  用于建立、配置以及测试数据链路的连接
一套网络控制协议NCPs 其中的每一个协议支持不同的网络层协议


帧格式
帧首
F  A  C  P  帧的数据部分  FCS  F 
1  1  1  2   不超过1500   2    1
标志(Flag) PPP帧的定界符，取值为0x7E
地址(Address) 取值为0xFF 预留
控制(Control)  取值为0x03 预留
协议(Protocol) 指明帧的数据部分送交哪个协议处理
  取值0x0021表示 :帧的数据部分为IP数据报
    0xC021:LCP分组
    0x8021:NCP分组
帧检验序列(Frame Check Sequence) CRC计算出的检验位


实现透明传输的方法
面向字节的异步链路 字节填充法 插入转义字符

发送方的处理
出现的每一个7E转为2字节序列(7D,5E)
每一个7D转为(7D,5D)
出现的每一个ASCll码控制字符(数值小于0x20的字符)，则在该字符前面插入一个7D字节，
同时将该字符的编码加上0x20

接收方 进行反变化即可恢复出原来的帧的数据部分


面向比特的同步链路 比特填充法 插入比特0

发送方
对帧的数据部分进行扫描。发现5个连续的比特1，填充一个比特0

接收 
发现5个连续的比特1，就把后面的0删了一个


差错检测
FCS计算范围
A C P 帧的数据部分
CRC-CCITT
接收方每接收到一个PPP帧，就进行CRC检验。若正确就收下这个帧，错误丢弃。使用PPP的数据链路层
向上不提供可靠传输服务



3.6.1 媒体接入控制的基本概念
共享信道要着重考虑的一个问题就是如何协调多个发送和接收站点对一个共享传输媒体的占用，即媒体接入控制MAC


3.6.2 静态划分信道

信道复用
频分复用FDM
频分复用的所有用户同时占用不同的频带资源并行通信
多址接入 频分多址FDMA

时分复用TDM
所有用户在不同的时间占用同样的频带宽度
时分多址TDMA

波分复用WDM


码分复用CDM  
是另一种共享信道的方法
多址接入 码分多址CDMA

用户可以在同样的时间使用同样的频带进行通信

在CDMA中
每一个比特时间再划分为m个短的间隔，称为码片 通常m值为64.128
使用CDMA的每一个站被指派一个唯一的m bit码片序列
一个站如果发送比特1，则发送它自己的m bit码片序列
发送0 ，发送自己的m bit码片序列的二进制反码
0011
发送1 0011
发送0 1100

习惯将码片序列中0为-1 1为+1

此种通信方式称为直接序列扩频DSSS


码片序列的挑选原则
1 分配给每个站的码片序列必须各不相同
2 分配给每个站的码片序列必须相互正交 规格化内积为0
ST=0
SS=1
ST(反码)=0
SS(反码)=0

收道的码片序列与各站进行求内积 结果为1发送比特1 结果为-1发送0 结果为0未发送


























